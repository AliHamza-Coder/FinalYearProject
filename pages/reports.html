<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deceptron - Case Reports</title>
    <link rel="stylesheet" href="../styles/output.css">
    <script src="../scripts/chart.min.js"></script>
    <link rel="stylesheet" href="../vendor/font-awesome/css/all.min.css">
    <link rel="stylesheet" href="../styles/sidebar.css">
    <style>
        :root {
            --primary-blue: #0076D6;
            --accent-cyan: #00DBFF;
            --bg-dark: #070B14;
            --sidebar-width: 260px;
        }

        :root {
            --primary-blue: #0076D6;
            --accent-cyan: #00DBFF;
            --bg-dark: #070B14;
            --sidebar-width: 260px;

            /* Theme Tokens */
            --bg-main: #05080f;
            --text-main: #e2e8f0;
            --text-dim: #94a3b8;
            --glass-bg: rgba(255, 255, 255, 0.03);
            --sidebar-bg: rgba(10, 17, 32, 0.98);
            --card-bg: rgba(16, 28, 45, 0.4);
            --border-subtle: rgba(255, 255, 255, 0.05);
        }

        body.light-mode {
            --bg-main: #f0f9ff;
            --text-main: #1e293b;
            --text-dim: #64748b;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --sidebar-bg: rgba(255, 255, 255, 0.9);
            --card-bg: rgba(255, 255, 255, 0.85);
            --border-subtle: rgba(0, 219, 255, 0.5);
        }

        body.light-mode .active-member-info {
            color: #22d3ee !important; /* cyan-400 */
            font-weight: 500;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-main);
            color: var(--text-main);
            margin: 0;
            overflow: hidden;
            width: 100vw;
            transition: background 0.3s ease, color 0.3s ease;
        }

        body:not(.light-mode) {
            background-image: 
                radial-gradient(at 0% 0%, hsla(210,100%,15%,0.15) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(180,100%,10%,0.1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(210,100%,15%,0.15) 0, transparent 50%),
                radial-gradient(at 50% 100%, hsla(340,100%,10%,0.05) 0, transparent 50%);
            background-attachment: fixed;
        }

        body.light-mode {
            background-image: 
                radial-gradient(at 0% 0%, rgba(224, 242, 254, 0.8) 0, transparent 50%),
                radial-gradient(at 100% 0%, rgba(207, 250, 254, 0.8) 0, transparent 50%),
                radial-gradient(at 50% 100%, rgba(240, 249, 255, 1) 0, transparent 50%);
            background-attachment: fixed;
        }

        .heading-font {
            font-family: 'Orbitron', sans-serif;
        }

        button, a, select, input[type="radio"], input[type="checkbox"], .nav-item, .cursor-pointer, .report-card {
            cursor: pointer !important;
        }

        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .main-content {
            margin-left: var(--sidebar-width);
            height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
            max-width: 100%;
        }

        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(25px) saturate(180%);
            border: 1px solid var(--border-subtle);
            border-radius: 2rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body.light-mode .glass {
            background: rgba(255, 255, 255, 0.98) !important;
            border: 2px solid rgba(0, 219, 255, 0.5) !important;
            box-shadow: 0 10px 40px rgba(0, 118, 214, 0.1) !important;
            border-radius: 2.5rem;
        }

        body.light-mode .glass:hover {
            border-color: rgba(0, 219, 255, 0.8) !important;
            box-shadow: 0 0 40px rgba(0, 219, 255, 0.25), 0 15px 45px rgba(0, 118, 214, 0.15) !important;
            transform: translateY(-2px);
        }

        .main-content {
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            gap: 2.5rem;
        }

        body.sidebar-collapsed #restore-sidebar {
            display: flex;
        }

        .report-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 1.5rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        body.light-mode .report-card {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(0, 219, 255, 0.4);
            box-shadow: 0 10px 40px rgba(0, 118, 214, 0.08);
            border-radius: 2rem;
        }

        .report-card:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: var(--accent-cyan);
            transform: translateY(-5px);
        }

        body.light-mode .report-card:hover {
            background: rgba(255, 255, 255, 0.98);
            border-color: rgba(0, 219, 255, 0.8);
            box-shadow: 0 0 40px rgba(0, 219, 255, 0.25), 0 15px 45px rgba(0, 118, 214, 0.15);
            transform: translateY(-5px);
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-size: 0.65rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-deceptive { background: rgba(239, 68, 68, 0.15); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.2); }
        .status-credible { background: rgba(16, 185, 129, 0.15); color: #34d399; border: 1px solid rgba(16, 185, 129, 0.2); }
        .status-uncertain { background: rgba(245, 158, 11, 0.15); color: #fbbf24; border: 1px solid rgba(245, 158, 11, 0.2); }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .search-bar {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 0.75rem 1.5rem;
            color: white;
            width: 100%;
            max-width: 400px;
            font-size: 0.875rem;
        }

        .search-bar:focus {
            outline: none;
            border-color: var(--accent-cyan);
            background: rgba(255, 255, 255, 0.08);
        }

        body.light-mode .search-bar {
            background: rgba(255, 255, 255, 0.8);
            border-color: rgba(0, 118, 214, 0.15);
            color: #1e293b;
        }

        body.light-mode .search-bar:focus {
            background: #ffffff;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 15px rgba(0, 219, 255, 0.1);
        }

        .chart-mini {
            height: 60px;
            width: 120px;
        }

        .logo-section img {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 10px rgba(0, 219, 255, 0.5));
        }

        /* Light Mode Utility Overrides */
        body.light-mode .bg-white\/5 {
            background-color: rgba(0, 118, 214, 0.05) !important;
        }

        body.light-mode .border-white\/10,
        body.light-mode .border-white\/5 {
            border-color: rgba(0, 118, 214, 0.1) !important;
        }

        body.light-mode .text-gray-400 {
            color: #475569 !important;
        }

        body.light-mode .text-gray-500 {
            color: #64748b !important;
        }

        body.light-mode .text-gray-600 {
            color: #94a3b8 !important;
        }
        
        body.light-mode .text-white {
            color: #1e293b !important;
        }

        body.light-mode .bg-slate-800 {
            background-color: rgba(0, 118, 214, 0.08) !important;
        }

        body.light-mode h1, 
        body.light-mode h2, 
        body.light-mode h3 {
            color: #1e293b !important;
        }

        body.light-mode .text-white,
        body.light-mode .text-gray-100,
        body.light-mode .text-gray-200,
        body.light-mode .text-gray-300 {
            color: #0f172a !important;
        }

        body.light-mode .text-gray-400,
        body.light-mode .text-gray-500 {
            color: #334155 !important;
        }

        body.light-mode .text-white,
        body.light-mode .text-gray-100,
        body.light-mode .text-gray-200,
        body.light-mode .text-gray-300 {
            color: #0f172a !important;
        }

        body.light-mode .bg-primary-blue .text-white,
        body.light-mode .bg-blue-600 .text-white,
        body.light-mode button.bg-primary-blue,
        body.light-mode button.bg-blue-600 {
            background-color: #00DBFF !important;
            color: #05080f !important;
            border: none !important;
            box-shadow: 0 4px 15px rgba(0, 219, 255, 0.3) !important;
        }

        body.light-mode button.bg-primary-blue:hover,
        body.light-mode button.bg-blue-600:hover {
            background-color: #00c4e0 !important;
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(0, 219, 255, 0.4) !important;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            display: inline-block;
            margin-right: 0.5rem;
            animation: pulse-glow 2s infinite;
        }

        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px #10b981; }
            50% { box-shadow: 0 0 20px #10b981; }
            100% { box-shadow: 0 0 5px #10b981; }
        }

        body.light-mode .transcript-box {
            background: rgba(0, 118, 214, 0.03);
            border-color: rgba(0, 118, 214, 0.1);
        }

        body.light-mode .transcript-item:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        body.light-mode .forensic-bg-override {
            background-color: var(--primary-blue) !important;
        }
    </style>
</head>
<body>
    <!-- Sidebar Component Container -->
    <script src="../js/components/sidebar.js"></script>
    <script>
        // Anti-Flash Theme Optimization
        (function() {
            const savedTheme = localStorage.getItem('theme');
            const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
            if (savedTheme === 'light' || (!savedTheme && prefersLight)) {
                document.body.classList.add('light-mode');
            }
            if (localStorage.getItem('sidebarCollapsed') === 'true') {
                document.body.classList.add('sidebar-collapsed');
            }
        })();
        initSidebar();
    </script>

    <!-- Main Content -->
    <main class="main-content">
        <header class="p-8 pb-4 flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold heading-font">All Saved Reports</h1>
                <div class="flex items-center mt-2 text-xs text-cyan-400 font-medium tracking-wide active-member-info">
                    <span class="status-dot"></span>
                    Active Member: <span class="ml-1 opacity-80">John Doe • Unit #DECEP-09</span>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <button id="theme-toggle" class="p-2.5 rounded-xl bg-white/5 border border-white/10 text-gray-400 hover:text-cyan-400 hover:bg-white/10 transition-all cursor-pointer" title="Toggle Theme">
                    <i class="fas fa-moon"></i>
                </button>
                <div class="flex items-center space-x-4">
                    <button class="px-6 py-2.5 bg-cyan-500/10 border border-cyan-500/30 text-cyan-400 text-[10px] font-bold uppercase rounded-xl hover:bg-cyan-500 hover:text-black transition-all duration-300 shadow-[0_4px_12px_rgba(0,219,255,0.1)] hover:shadow-[0_0_20px_rgba(0,219,255,0.4)] flex items-center" onclick="triggerImport()">
                        <i class="fas fa-file-import mr-2"></i> Import Report
                    </button>
                    <input type="text" placeholder="Search by name or ref #" class="search-bar">
                    <button class="p-2 bg-white/5 rounded-xl hover:bg-white/10 transition-colors cursor-pointer">
                        <i class="fas fa-filter text-gray-400"></i>
                    </button>
                </div>
            </div>
        </header>

        <section class="p-8 grid grid-cols-1 gap-6">
            <!-- Report Items -->
            <div class="report-card p-6 flex flex-wrap lg:flex-nowrap items-center gap-8" onclick="window.location.href='report-detail.html'">
                <div class="flex items-center space-x-4 lg:w-1/4">
                    <div class="w-12 h-12 rounded-2xl bg-slate-800 flex items-center justify-center text-xl text-gray-500 border border-white/5">
                        <i class="fas fa-user-secret"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold">John Doe</h3>
                        <p class="text-[10px] text-gray-500 uppercase tracking-widest font-bold">Ref: #4092 • Corporate Espionage</p>
                    </div>
                </div>
                
                <div class="flex-1 grid grid-cols-2 md:grid-cols-4 gap-8">
                    <div>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Date</p>
                        <p class="text-sm text-white">Feb 03, 2026</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Duration</p>
                        <p class="text-sm text-white">45m 12s</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Truth Score</p>
                        <p class="text-sm font-bold text-rose-500">22% (Critical Risk)</p>
                    </div>
                    <div>
                        <span class="status-badge status-deceptive">Deceptive High</span>
                    </div>
                </div>

                <div class="chart-mini">
                    <canvas id="chart4092"></canvas>
                </div>

                <div class="flex items-center space-x-3">
                    <button class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center hover:bg-white/10 text-cyan-400 transition-all cursor-pointer" onclick="window.location.href='report-detail.html'"><i class="fas fa-eye"></i></button>
                    <button class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center hover:bg-white/10 text-gray-400 transition-all cursor-pointer"><i class="fas fa-download"></i></button>
                </div>
            </div>

            <!-- Repeat for other cards with onclick -->
            <div class="report-card p-6 flex flex-wrap lg:flex-nowrap items-center gap-8" onclick="window.location.href='report-detail.html'">
                <div class="flex items-center space-x-4 lg:w-1/4">
                    <div class="w-12 h-12 rounded-2xl bg-slate-800 flex items-center justify-center text-xl text-gray-500 border border-white/5">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <h3 class="text-lg font-bold">Jane Smith</h3>
                        <p class="text-[10px] text-gray-500 uppercase tracking-widest font-bold">Ref: #4091 • Background Check</p>
                    </div>
                </div>
                
                <div class="flex-1 grid grid-cols-2 md:grid-cols-4 gap-8">
                    <div>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Date</p>
                        <p class="text-sm text-white">Feb 02, 2026</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Duration</p>
                        <p class="text-sm text-white">12m 05s</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Truth Score</p>
                        <p class="text-sm font-bold text-emerald-500">94% (Verified)</p>
                    </div>
                    <div>
                        <span class="status-badge status-credible">Credible</span>
                    </div>
                </div>

                <div class="chart-mini">
                    <canvas id="chart4091"></canvas>
                </div>

                <div class="flex items-center space-x-3">
                    <button class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center hover:bg-white/10 text-cyan-400 transition-all cursor-pointer" onclick="window.location.href='report-detail.html'"><i class="fas fa-eye"></i></button>
                    <button class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center hover:bg-white/10 text-gray-400 transition-all cursor-pointer"><i class="fas fa-download"></i></button>
                </div>
            </div>
        </section>
    </main>

    <!-- Report Detail Modal -->
    <div id="reportModal" class="fixed inset-0 bg-black/80 backdrop-blur-xl z-[100] hidden flex items-center justify-center p-6">
        <div class="w-full max-w-6xl glass rounded-[2.5rem] p-10 max-h-[90vh] overflow-y-auto relative border border-white/10 shadow-2xl">
            <button onclick="closeReportDetail()" class="absolute top-8 right-8 text-gray-400 hover:text-white transition-colors cursor-pointer">
                <i class="fas fa-times text-2xl"></i>
            </button>

            <div class="flex items-center justify-between mb-12">
                <div class="flex items-center space-x-6">
                    <div class="w-20 h-20 rounded-3xl bg-gradient-to-br from-blue-600 to-cyan-400 p-0.5 shadow-lg shadow-cyan-500/20">
                        <div class="w-full h-full bg-[#070B14] rounded-3xl flex items-center justify-center forensic-bg-override">
                            <i class="fas fa-user-shield text-3xl text-white"></i>
                        </div>
                    </div>
                    <div>
                        <h2 id="modalSubject" class="text-3xl font-bold heading-font uppercase text-white tracking-widest">---</h2>
                        <div class="flex items-center space-x-4 mt-2">
                            <span id="modalRef" class="text-xs font-mono text-cyan-400 tracking-tighter uppercase font-bold">Ref: #-----</span>
                            <span class="w-1.5 h-1.5 bg-white/20 rounded-full"></span>
                            <span class="text-xs text-gray-400 uppercase tracking-widest font-bold">Forensic Signature Verified</span>
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-1">Confidential Rating</p>
                    <div class="flex items-center space-x-2">
                        <span class="text-4xl font-black heading-font text-white">9.8</span>
                        <div class="flex flex-col">
                            <span class="text-[10px] text-emerald-500 font-bold uppercase">Critical</span>
                            <span class="text-[10px] text-gray-600 uppercase">Analysis</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Data Columns -->
                <div class="col-span-2 space-y-8">
                    <div class="glass p-8 rounded-3xl">
                        <h3 class="text-sm font-bold heading-font uppercase tracking-widest mb-8 text-white flex items-center">
                            <i class="fas fa-chart-line mr-3 text-cyan-400"></i> Truth Level Analysis
                        </h3>
                        <div class="h-64">
                            <canvas id="detailChart"></canvas>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="glass p-6 rounded-2xl">
                            <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-4">Facial Micro-Expressions</p>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex justify-between text-[10px] mb-2 uppercase tracking-wide">
                                        <span class="text-gray-300">Asymmetry Detection</span>
                                        <span class="text-rose-500">88%</span>
                                    </div>
                                    <div class="h-1 bg-white/5 rounded-full overflow-hidden">
                                        <div class="h-full bg-rose-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]" style="width: 88%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-[10px] mb-2 uppercase tracking-wide">
                                        <span class="text-gray-300">Micro-Stress Shifts</span>
                                        <span class="text-amber-500">64%</span>
                                    </div>
                                    <div class="h-1 bg-white/5 rounded-full overflow-hidden">
                                        <div class="h-full bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.5)]" style="width: 64%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="glass p-6 rounded-2xl">
                            <p class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-4">Voice Stress Test</p>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex justify-between text-[10px] mb-2 uppercase tracking-wide">
                                        <span class="text-gray-300">Pitch Instability</span>
                                        <span class="text-cyan-500">22%</span>
                                    </div>
                                    <div class="h-1 bg-white/5 rounded-full overflow-hidden">
                                        <div class="h-full bg-cyan-500 shadow-[0_0_8px_rgba(0,219,255,0.5)]" style="width: 22%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-[10px] mb-2 uppercase tracking-wide">
                                        <span class="text-gray-300">Jitter/Shimmer Ratio</span>
                                        <span class="text-cyan-500">18%</span>
                                    </div>
                                    <div class="h-1 bg-white/5 rounded-full overflow-hidden">
                                        <div class="h-full bg-cyan-500 shadow-[0_0_8px_rgba(0,219,255,0.5)]" style="width: 18%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Summary Column -->
                <div class="space-y-6">
                    <div class="glass p-8 rounded-3xl border-l-4 border-rose-500">
                        <h3 class="text-xs font-bold uppercase tracking-[0.2em] mb-4 text-rose-500">Final Summary Result</h3>
                        <p class="text-sm text-gray-300 leading-relaxed font-medium">Subject shows high-probability deceptive indicators during baseline interrogation. Neural engine identified concentrated micro-tremors during financial disclosure section.</p>
                        <div class="mt-8 p-4 bg-rose-500/10 border border-rose-500/20 rounded-xl">
                            <p class="text-[10px] text-rose-500 uppercase font-bold tracking-widest mb-1">Verdict Status</p>
                            <p class="text-lg font-black heading-font text-white uppercase text-rose-500">DECEPTIVE</p>
                        </div>
                    </div>

                    <div class="glass p-8 rounded-3xl">
                        <h3 class="text-[10px] text-gray-500 uppercase font-bold tracking-widest mb-6">Action Protocols</h3>
                        <div class="space-y-3">
                            <button class="w-full py-4 bg-white/5 border border-white/10 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:bg-white/10 transition-all text-white cursor-pointer">
                                <i class="fas fa-file-pdf mr-2"></i> Export PDF Report
                            </button>
                            <button class="w-full py-4 bg-white/5 border border-white/10 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:bg-white/10 transition-all text-white cursor-pointer">
                                <i class="fas fa-share-alt mr-2"></i> Share Intelligence
                            </button>
                            <button class="w-full py-4 bg-rose-500/10 border border-rose-500/20 rounded-xl text-[10px] font-bold uppercase tracking-widest text-rose-500 hover:bg-rose-500 hover:text-white transition-all cursor-pointer">
                                <i class="fas fa-trash-alt mr-2"></i> Archive Case
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const body = document.body;
        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { display: false } },
            scales: { x: { display: false }, y: { display: false, min: 0, max: 100 } }
        };

        // Mini Charts init
        function initMiniCharts() {
            new Chart(document.getElementById('chart4092').getContext('2d'), {
                type: 'line',
                data: { labels: [1,2,3,4,5], datasets: [{ data: [80, 40, 90, 85, 95], borderColor: '#f87171', borderWidth: 2, tension: 0.4, pointRadius: 0 }] },
                options: chartOptions
            });
            new Chart(document.getElementById('chart4091').getContext('2d'), {
                type: 'line',
                data: { labels: [1,2,3,4,5], datasets: [{ data: [10, 15, 8, 12, 5], borderColor: '#34d399', borderWidth: 2, tension: 0.4, pointRadius: 0 }] },
                options: chartOptions
            });
        }
        initMiniCharts();

        // Detail Chart Global Instance
        let detailChartInstance = null;
        function initDetailChart() {
            const ctx = document.getElementById('detailChart').getContext('2d');
            detailChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['0m', '10m', '20m', '30m', '40m', '50m'],
                    datasets: [{
                        label: 'Deception Prob',
                        data: [20, 35, 88, 70, 94, 98],
                        borderColor: '#f87171',
                        backgroundColor: 'rgba(248, 113, 113, 0.1)',
                        fill: true,
                        tension: 0.4,
                        borderWidth: 3,
                        pointBackgroundColor: '#f87171'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, grid: { color: body.classList.contains('light-mode') ? 'rgba(0,118,214,0.1)' : 'rgba(255,255,255,0.05)' }, ticks: { color: body.classList.contains('light-mode') ? '#475569' : '#666' } },
                        x: { grid: { display: false }, ticks: { color: body.classList.contains('light-mode') ? '#475569' : '#666' } }
                    }
                }
            });
        }

        // Modal Logic
        function openReportDetail(subject, ref) {
            document.getElementById('modalSubject').innerText = subject;
            document.getElementById('modalRef').innerText = "Ref: " + ref;
            document.getElementById('reportModal').classList.remove('hidden');
            if(!detailChartInstance) {
                initDetailChart();
            }
        }

        function closeReportDetail() {
            document.getElementById('reportModal').classList.add('hidden');
        }

        function triggerImport() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,.bin,.dec';
            input.onchange = e => {
                alert('Intelligence data found. Parsing external forensic session...');
            };
            input.click();
        }

        function toggleSidebar() {
            body.classList.toggle('sidebar-collapsed');
            localStorage.setItem('sidebarCollapsed', body.classList.contains('sidebar-collapsed'));
        }

        // Theme Toggle Logic
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = themeToggle.querySelector('i');

        function toggleTheme() {
            const isLight = body.classList.toggle('light-mode');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
            updateThemeUI(isLight);
        }

        function updateThemeUI(isLight) {
            themeIcon.className = isLight ? 'fas fa-sun' : 'fas fa-moon';
            themeToggle.classList.toggle('bg-gray-200', isLight);
            themeToggle.classList.toggle('text-gray-900', isLight);
            themeToggle.classList.toggle('border-gray-300', isLight);
        }

        themeToggle.addEventListener('click', toggleTheme);

        // Initial Load
        document.addEventListener('DOMContentLoaded', () => {
            // Update Theme UI state (icons, buttons)
            updateThemeUI(body.classList.contains('light-mode'));
        });
        function closeApp() {
            if(confirm("Are you sure you want to logout?")) {
                window.location.href = 'login.html';
            }
        }
    </script>
</body>
</html>
